<div class="view-container">
  <div class="view-header">
    <a routerLink="/app/accounting/journal-entries" class="btn-icon">
      <lucide-icon [name]="BackIcon" [size]="24"></lucide-icon>
    </a>
    <h1>Importar Asientos Contables</h1>
  </div>

  <div class="view-content">
    <div class="card">
      <div class="card-header">
        <h2>Paso 1: Seleccionar Fichero</h2>
      </div>
      <div class="card-body">
        <div class="upload-box" (click)="fileInput.click()">
          <input #fileInput type="file" (change)="onFileSelected($event)" hidden accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel">
          <lucide-icon [name]="UploadIcon" [size]="48"></lucide-icon>
          <p *ngIf="!selectedFile()">Haz clic aquí para seleccionar un fichero (CSV, Excel)</p>
          <p *ngIf="selectedFile()">Fichero seleccionado: <strong>{{ selectedFile()?.name }}</strong></p>
        </div>
        <div class="form-actions">
          <button (click)="previewImport()" class="btn-primary" [disabled]="!selectedFile() || isLoading()">
            {{ isLoading() ? 'Procesando...' : 'Previsualizar Importación' }}
          </button>
        </div>
      </div>
    </div>

    <div *ngIf="isLoading()" class="loading-shade">
      <p>Analizando el fichero...</p>
    </div>

    <div *ngIf="error()" class="error-message">
      <p>{{ error() }}</p>
    </div>

    <div *ngIf="previewData()" class="card">
      <div class="card-header">
        <h2>Paso 2: Previsualización y Confirmación</h2>
      </div>
      <div class="card-body">
        <!-- The preview data table would be rendered here -->
        <p>Previsualización de los datos a importar:</p>
        <pre>{{ previewData() | json }}</pre>
        <div class="form-actions">
          <button (click)="confirmImport()" class="btn-primary">Confirmar e Importar</button>
        </div>
      </div>
    </div>

  </div>
</div>
